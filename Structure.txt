################################################################################
#                              BEEMANCER - STRUCTURE                           #
#                         Dernière mise à jour: 2026-02-07                     #
#  (Storage Hive (3 Tiers) - 2026-02-07)                                       #
################################################################################

================================================================================
TABLE DES MATIÈRES
================================================================================
1. VUE D'ENSEMBLE
2. ARBORESCENCE COMPLÈTE
3. FICHIERS FONDAMENTAUX (CORE)
4. REGISTRES
5. FEATURES IMPLÉMENTÉES
6. FEATURES EN COURS
7. DÉPENDANCES UNIVERSELLES
8. GUIDE D'INTÉGRATION D'UNE FEATURE
9. CHANGELOG STRUCTURE

================================================================================
1. VUE D'ENSEMBLE
================================================================================

Mod: Beemancer
Version MC: 1.21.1
Loader: NeoForge
Package racine: com.chapeau.beemancer

Philosophie:
- Modularité maximale (1 script = 1 responsabilité)
- Système de gènes modulaire pour les abeilles
- Patterns inspirés de Create et Cobblemon

================================================================================
2. ARBORESCENCE COMPLÈTE
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/arborescence.txt                               │
│ POUR AJOUTER: Éditer directement le fichier                                 │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/arborescence.txt

================================================================================
3. FICHIERS FONDAMENTAUX (CORE)
================================================================================

┌─────────────────────────────────────┬────────────────────────────────────────┐
│ Fichier                             │ Rôle                                   │
├─────────────────────────────────────┼────────────────────────────────────────┤
│ Beemancer.java                      │ Point d'entrée, init gènes + behaviors │
│ core/gene/Gene.java                 │ Interface pour tous les gènes          │
│ core/gene/GeneRegistry.java         │ Registre central des gènes             │
│ core/gene/GeneCategory.java         │ Définition des catégories              │
│ core/gene/BeeGeneData.java          │ Stockage gènes                         │
│ core/behavior/BeeBehaviorManager.java│ Chargement config comportements       │
│ core/breeding/BreedingManager.java  │ Logique breeding + héritage            │
│ core/util/FlowerSearchHelper.java   │ Recherche de fleurs dans un rayon      │
│ core/util/HarvestHelper.java        │ Logique récolte par type de bloc       │
│ core/recipe/BeemancerRecipeTypes.java│ Registre des types de recettes        │
│ core/recipe/BeemancerRecipeSerializers.java│ Registre des serializers        │
│ core/recipe/ProcessingOutput.java   │ Output avec probabilité                │
│ core/recipe/FluidIngredient.java    │ Ingredient fluide pour recettes        │
│ content/gene/GeneInit.java          │ Enregistrement de tous les gènes       │
│ client/ClientSetup.java             │ Init client (screens, renderers)       │
│ client/renderer/item/MagicBeeItemRenderer│ BEWLR rendu 3D abeille en inventaire│
│ common/item/debug/DebugWandItem       │ Baguette debug avec 9 valeurs        │
│ client/gui/hud/DebugPanelRenderer     │ HUD panneau debug valeurs            │
│ client/input/DebugKeyHandler          │ Gestion touches debug panel          │
│ client/renderer/entity/MagicBeeRenderer│ Renderer entité avec texture espèce  │
│ common/codex/CodexManager.java      │ Gestionnaire central du Codex          │
│ client/renderer/block/AltarHeartRenderer│ Renderer multibloc Honey Altar     │
│ client/gui/hud/RideableBeeDebugHud  │ HUD debug rideable bee (haut droit)    │
│ client/renderer/debug/PipeDebugRenderer│ Texte debug au-dessus des pipes     │
│ client/renderer/debug/HiveDebugRenderer│ Cooldowns au-dessus des ruches      │
│ client/renderer/util/FluidCubeRenderer │ Rendu fluide avec sélection faces  │
│ client/renderer/util/DebugRenderHelper │ Lignes et cubes debug partagés     │
│ common/block/alchemy/AbstractPipeBlock │ Base commune pipes (Item+Honey)    │
│ common/menu/BeemancerMenu              │ Base menus (player inv/hotbar)     │
│ common/entity/bee/goal/MoveToTargetGoal│ Goal navigation bee via BeeWand    │
│ common/blockentity/storage/           │                                        │
│   StorageChestManager               │ Gestion coffres réseau stockage      │
│   StorageItemAggregator             │ Agrégation/dépôt/extraction items    │
│   StorageDeliveryManager            │ Queue livraison + spawn/recall bees  │
│   RequestManager                    │ Demandes interfaces/terminaux        │
│   StorageMultiblockManager          │ Formation/destruction multibloc      │
│ common/block/hive/                    │                                        │
│   HiveBeeLifecycleManager           │ Cycle de vie abeilles dans ruche     │
│ client/gui/GuiRenderHelper.java      │ Rendu programmatique GUIs partagé    │
│ core/util/ParticleHelper.java        │ Utilitaire statique spawn particules │
│ core/multiblock/MultiblockProperty.java│ Enum + factory blockstate property │
│ core/multiblock/MultiblockCapabilityProvider│ Interface délégation caps multibloc│
│ core/multiblock/IOMode.java            │ Enum NONE/INPUT/OUTPUT/BOTH        │
│ core/multiblock/BlockIORule.java       │ Règles IO per-face pour un bloc    │
│ core/multiblock/MultiblockIOConfig.java│ Config IO complète d'un multibloc  │
│ core/util/SplitFluidHandler.java      │ Wrapper fill→input, drain→output + factories│
│ core/util/SplitItemHandler.java       │ Wrapper insert→input, extract→output + factories│
└─────────────────────────────────────┴────────────────────────────────────────┘

================================================================================
4. REGISTRES
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/registries_items.txt                           │
│ POUR AJOUTER: Éditer BeemancerItems.java puis mettre à jour le fichier      │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/registries_items.txt

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/registries_blocks.txt                          │
│ POUR AJOUTER: Éditer BeemancerBlocks.java puis mettre à jour le fichier     │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/registries_blocks.txt

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/registries_entities.txt                        │
│ POUR AJOUTER: Éditer BeemancerEntities.java puis mettre à jour le fichier   │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/registries_entities.txt

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/registries_menus.txt                           │
│ POUR AJOUTER: Éditer BeemancerMenus.java puis mettre à jour le fichier      │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/registries_menus.txt

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/registries_flower_genes.txt                    │
│ POUR AJOUTER: Créer FlowerGene + tag puis mettre à jour le fichier          │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/registries_flower_genes.txt

┌─────────────────────────────────────────────────────────────────────────────┐
│ REGISTRES DE RECETTES (core/recipe/)                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│ BeemancerRecipeTypes:                                                        │
│   - CENTRIFUGING (1 item → fluide + items avec probas)                       │
│   - INFUSING (1 item + fluide → 1 item)                                      │
│   - CRYSTALLIZING (1 fluide → 1 item)                                        │
│   - DISTILLING (2 fluides → 1 fluide)                                        │
│                                                                              │
│ BeemancerRecipeSerializers:                                                  │
│   - CENTRIFUGE_SERIALIZER                                                    │
│   - INFUSING_SERIALIZER                                                      │
│   - CRYSTALLIZING_SERIALIZER                                                 │
│   - DISTILLING_SERIALIZER                                                    │
└─────────────────────────────────────────────────────────────────────────────┘

================================================================================
5. FEATURES IMPLÉMENTÉES
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│ POUR AJOUTER UNE FEATURE:                                                   │
│ 1. Créer un fichier Structure/feature_[nom].txt                             │
│ 2. Documenter architecture, fonctionnement, fichiers liés                   │
│ 3. Ajouter la référence ci-dessous                                          │
│ 4. Mettre à jour Structure/changelog.txt                                    │
└─────────────────────────────────────────────────────────────────────────────┘

LISTE DES FEATURES:
--------------------------------------------------------------------------------

→ Codex System
  Fichier: Structure/feature_codex.txt
  Description: Système de livre de connaissances avec 3 onglets et nodes de progression

→ Harvester Behavior System
  Fichier: Structure/feature_harvester_behavior.txt
  Description: Système de récolte automatique pour les abeilles récolteuses

→ Bee Behavior System  
  Fichier: Structure/feature_bee_behavior.txt
  Description: Système de comportement automatique des abeilles

→ Gene System
  Fichier: Structure/feature_gene_system.txt
  Description: Système modulaire de gènes pour les abeilles

→ Magic Bee
  Fichier: Structure/feature_magic_bee.txt
  Description: Abeille avec système de gènes et comportements

→ Bee Creator
  Fichier: Structure/feature_bee_creator.txt
  Description: Interface GUI pour modifier les gènes des abeilles

→ Magic Hive
  Fichier: Structure/feature_magic_hive.txt
  Description: Ruche magique pour héberger les MagicBees

→ Bee Wand
  Fichier: Structure/feature_bee_wand.txt
  Description: Baguette pour observer et contrôler les entités

→ Breeding System
  Fichier: Structure/feature_breeding_system.txt
  Description: Système de reproduction des abeilles

→ Alchemy Processing System
  Fichier: Structure/feature_alchemy_system.txt
  Description: Système de traitement alchimique modulaire basé sur recettes JSON

→ Storage Network System
  Fichier: Structure/feature_storage_network.txt
  Description: Système de stockage centralisé avec contrôleur et terminal (style AE2/RS)

→ Building Wand
  Fichier: Structure/feature_building_wand.txt
  Description: Baguette de construction avec prévisualisation flood fill 2D

→ Honey Altar
  Fichier: Structure/feature_honey_altar.txt
  Description: Multibloc 3x3x5 servant d'autel magique pour le Beemancer

→ Multiblock System
  Fichier: Structure/feature_multiblock_system.txt
  Description: Système modulaire et réutilisable pour créer des structures multiblocs

→ Tiered Machines
  Fichier: Structure/feature_tiered_machines.txt
  Description: Système de tiers pour machines d'alchimie (centrifuge, tanks, pipes)

→ Multiblock Fluid Tank
  Fichier: Structure/feature_multiblock_tank.txt
  Description: Tank extensible style honey tank avec connexions visuelles et rendu fluide par bloc

→ Hive Multiblock
  Fichier: Structure/feature_hive_multiblock.txt
  Description: Ruche multibloc 3x3x3 + slabs, fonctionne comme MagicHive

→ Debug Wand
  Fichier: Structure/feature_debug_wand.txt
  Description: Baguette de debug avec 9 valeurs ajustables en temps réel via HUD

→ Pollen Pot
  Fichier: Structure/feature_pollen_pot.txt
  Description: Pot de stockage pour 16 pollens d'un seul type avec interactions clic

→ Essence Extractor
  Fichier: Structure/feature_essence_extractor.txt
  Description: Multibloc 3x3x4 pour extraire des essences + 20 items d'essence (5 types × 4 niveaux)

→ Bee Statue
  Fichier: Structure/feature_bee_statue.txt
  Description: Statue décorative affichant une espèce d'abeille avec interactions

→ Honey Reservoir + Altar Heart
  Fichier: Structure/feature_honey_reservoir.txt
  Description: Réservoir fluide + Coeur d'Autel (contrôleur) pour multibloc Honey Altar

→ Rideable Bee
  Fichier: Structure/feature_rideable_bee.txt
  Description: Abeille chevauchable avec modes WALK/RUN et caméra dynamique (inspiré Cobblemon)

→ Debug Display System
  Fichier: Structure/feature_debug_display.txt
  Description: Affichages debug visuels (HUD rideable bee, texte pipes/ruches) quand displayDebug=true

→ Programmatic GUI Overhaul
  Fichier: Structure/feature_gui_overhaul.txt
  Description: Conversion de tous les écrans (10) du rendu texture vers rendu programmatique avec GuiRenderHelper

→ Crank Block
  Fichier: Structure/feature_crank.txt
  Description: Bloc manivelle pour centrifugeuse manuelle, placement conditionnel au-dessus

→ Storage Terminal Overhaul
  Fichier: Structure/feature_storage_terminal_overhaul.txt
  Description: Refonte complète du terminal (3 onglets, crafting, annulation tâches, GUI programmatique, noPhysics bees)

→ Particle System
  Fichier: Structure/feature_particle_system.txt
  Description: Système de particules statique avec EffectTypes prédéfinis et surcharges ResourceLocation

→ Multibloc Blockstate Refonte
  Fichier: Structure/feature_multiblock_blockstate_refonte.txt
  Description: Remplacement BooleanProperty FORMED par EnumProperty<MultiblockProperty> sur 16 blocs + 3 nouveaux Heart blocks alchemy

→ Flywheel Test Bee
  Fichier: Structure/feature_flywheel_test_bee.txt
  Description: Proof of concept GPU instancing via Flywheel pour rendu abeilles

→ Delivery System Refactoring (5 phases)
  Fichier: Structure/feature_delivery_refactoring.txt
  Description: Refonte complète du système de livraison: RequestManager, flux unifié, recall bees, localisation GUI

→ Multiblock Capability Delegation + IO Config System
  Description: Système déclaratif de délégation de capabilities (fluid+item) des blocs structurels vers le contrôleur multibloc, avec configuration IO per-face per-position
  Scripts créés: MultiblockCapabilityProvider.java, IOMode.java, BlockIORule.java, MultiblockIOConfig.java
  Scripts modifiés: SplitFluidHandler.java (+inputOnly/outputOnly factories), SplitItemHandler.java (+inputOnly/outputOnly factories), CentrifugeHeartBlockEntity.java (IO_CONFIG déclaratif, top=INPUT/bottom=OUTPUT), AlembicHeartBlockEntity.java (+MultiblockCapabilityProvider, IO_CONFIG, reservoir linking), Beemancer.java (Alembic delegation, Infuser item capability)
  Dépendances: MultiblockController, IFluidHandler, IItemHandler, HoneyReservoirBlockEntity
  Registres modifiés: Capabilities (fluid+item) pour HONEY_RESERVOIR, CENTRIFUGE_HEART, ALEMBIC_HEART, INFUSER_HEART

→ Codex Book V1 (Sections + Sticky Notes)
  Description: Système de livre modulaire avec sections (header, text, model, stats) et sticky notes en overlay
  Scripts créés: StickyNote.java, StatsSection.java, ModelSection.java
  Scripts modifiés: CodexBookScreen.java, CodexBookContent.java, meadow_bee.json + 97 bee JSONs
  Assets: 97 fichiers data/beemancer/codex/book/*.json
  Dépendances: CodexBookManager, BookPageLayout, BeeSpeciesManager

→ Codex Decorations (Cracks, Stains, Borders)
  Description: Décorations aléatoires sur le background du CodexScreen (suivent le scroll)
  Scripts créés: CodexDecorationRenderer.java
  Scripts modifiés: CodexScreen.java
  Assets: crack_1-4.png, stain_1-2.png, page_border.png
  Dépendances: CodexPage

→ Centrifuge Comb Tag Filter
  Description: La centrifugeuse accepte tout item du tag beemancer:combs au lieu d'une whitelist hardcodée
  Scripts modifiés: PoweredCentrifugeMenu.java
  Dépendances: BeemancerTags.Items.COMBS

→ Empty Comb Slot Texture
  Description: Affichage de la texture empty_slot_comb dans les slots comb input
  Assets créés: atlases/blocks.json (enregistrement texture dans le block atlas)

→ Centrifuge Heart Working Texture
  Description: Le coeur de centrifuge formé affiche une texture différente quand working=true
  Assets créés: models/block/alchemy/centrifuge_heart_centrifuge_working.json
  Assets modifiés: blockstates/centrifuge_heart.json

→ Storage Hive (3 Tiers)
  Description: Bloc ruche liee directement au Storage Controller. 3 tiers (T1=+1 bee, T2=+2, T3=+3). Consommation miel multiplicative (T1=x1.5, T2=x2.0, T3=x2.5). +1 slot essence par hive (max 4 hives = 8 slots total). 3 etats visuels: UNLINKED, LINKED, ACTIVE.
  Scripts crees: StorageHiveBlock.java, StorageHiveBlockEntity.java
  Scripts modifies: StorageControllerBlockEntity.java, StorageNetworkRegistry.java, StorageEvents.java, ControllerStats.java, StorageDeliveryManager.java, StorageMultiblockManager.java, StorageControllerMenu.java, StorageControllerScreen.java
  Assets: 3 blockstates, 9 block models, 3 item models, 3 loot tables
  Registres modifies: BeemancerBlocks (+3), BeemancerItems (+3), BeemancerBlockEntities (+1)

→ Dynamic Delivery Task System
  Description: Systeme de taches de livraison dynamique. Les abeilles s'adaptent a la quantite disponible a la source (extraction dynamique jusqu'a maxStackSize). Le controller reevalue les taches toutes les 20 ticks (split/merge/cancel). Redirection mid-flight: quand une tache est annulee, l'abeille va au relay le plus proche et prend une nouvelle tache sans revenir au controller. Phase SAVING_INVENTORY pour deposer les items avant redirect. Slots bonus essence toujours visibles (verrouilles si hives insuffisantes).
  Scripts modifies: DeliveryPhaseGoal.java, DeliveryBeeEntity.java, StorageDeliveryManager.java, RequestManager.java, StorageControllerMenu.java, StorageControllerScreen.java

================================================================================
6. FEATURES EN COURS
================================================================================

[Aucune]

================================================================================
7. DÉPENDANCES UNIVERSELLES
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/dependencies.txt                               │
│ POUR AJOUTER: Créer la dépendance puis mettre à jour le fichier             │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/dependencies.txt

================================================================================
8. GUIDE D'INTÉGRATION D'UNE FEATURE
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/integration_guide.txt                          │
│ POUR MODIFIER: Éditer directement le fichier                                │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/integration_guide.txt

================================================================================
9. CHANGELOG STRUCTURE
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│ FICHIER DE DÉTAIL: Structure/changelog.txt                                  │
│ POUR AJOUTER: Éditer directement le fichier avec nouvelle entrée en haut    │
└─────────────────────────────────────────────────────────────────────────────┘
→ Voir: Structure/changelog.txt

################################################################################
#                              FIN DU DOCUMENT                                  #
################################################################################

################################################################################
#                            CHANGELOG                                         #
################################################################################

================================================================================
2026-02-08 - Fix Storage Hive Phase 2 (Getter pur + linkHive symétrique)
================================================================================

FIX: linkHive() self-contained (symétrique avec unlinkHive)
- linkHive() notifie maintenant la hive automatiquement (hive.linkToController)
- StorageEvents.java ne fait plus le double appel redondant lors du linking
- Pattern conforme à Create: removeController() self-contained

FIX: getController() getter pur (sans side-effect)
- getController() ne modifie plus l'état de la hive quand le controller est absent
- Retourne simplement null si invalide, conforme au pattern Create getControllerBE()
- Élimine les auto-unlink surprises lors d'appels depuis updateVisualState()

FIX: serverTick() validation explicite
- Auto-unlink explicite quand le chunk est chargé mais le controller absent
- Chunk pas chargé = aucune action (pas de faux delink lors du chunk unload)
- Controller présent = sync état visuel (LINKED/ACTIVE)
- Sécurisé contre Forge Issue #8302 (setRemoved pendant chunk unload)

================================================================================
2026-02-08 - Fix Storage Hive Linking Bugs (Phase 1)
================================================================================

FIX: validateNetworkBlocks() cleanup correct des hives
- Les hives retirees lors de la validation sont maintenant notifiees (unlinkController)
- dropOverflowEssences() appele quand des hives sont retirees du registre
- Verification que controllerPos pointe vers CE controller (pas un autre)
- Meme verification ajoutee pour TERMINAL et INTERFACE

FIX: unlinkHive() self-contained
- unlinkHive() notifie maintenant la hive automatiquement (hive.unlinkController)
- StorageEvents.java ne fait plus le double appel redondant

FIX: Validation periodique du reseau
- Ajout timer de validation toutes les 200 ticks dans serverTick()
- Detecte les blocs casses/invalides sans avoir a ouvrir le mode edition

================================================================================
2026-02-08 - Fix Slot Visibility + Delivery Task Redesign
================================================================================

FIX: Slots bonus essence invisibles
- DynamicEssenceSlot.isActive() retourne toujours true (slots rendus par Minecraft)
- Ajout isUnlocked() pour verifier si le slot est fonctionnellement actif
- Slots verrouilles affichent un fond grise avec barre
- Ajout isBonusSlotUnlocked() sur le menu pour query depuis le Screen

FEATURE: Extraction dynamique
- L'abeille prend tout ce qui est disponible a la source (jusqu'a maxStackSize)
- Plus de snapshot de quantite au spawn

FEATURE: Reevaluation periodique des taches
- Controller reevalue les taches toutes les 20 ticks
- Split des taches QUEUED si count > beeCapacity
- Cancel des taches si demande tombe a 0
- Sous-taches creees pour surplus quand demande augmente sur tache en vol
- Les requests ASSIGNED mettent aussi a jour leur count

FEATURE: Redirection mid-flight
- Annulation de tache avec redirection vers nouvelle tache sans retour controller
- La bee va au noeud reseau le plus proche (findNearestNetworkNode)
- Phase REDIRECTING: vol vers relay, puis applyNewTask, puis FLY_TO_SOURCE
- Phase SAVING_INVENTORY: depot des items transportes avant redirect
- cancelAndRedirect() sur DeliveryBeeEntity pour pousser une nouvelle tache
- redirectBee() sur StorageDeliveryManager pour orchestrer la redirection
- cancelTask() tente une redirection vers tache en queue avant recall simple

SCRIPTS MODIFIES (6):
- StorageControllerMenu, StorageControllerScreen
- DeliveryPhaseGoal, DeliveryBeeEntity
- StorageDeliveryManager, RequestManager

================================================================================
2026-02-07 - Storage Hive (3 Tiers)
================================================================================

NOUVEAU BLOC: Storage Hive (3 tiers)
- storage_hive: StorageHiveBlock (tier 1, +1 delivery bee, miel x1.5)
- storage_hive_tier2: StorageHiveBlock (tier 2, +2 delivery bees, miel x2.0)
- storage_hive_tier3: StorageHiveBlock (tier 3, +3 delivery bees, miel x2.5)

FONCTIONNEMENT:
- Bloc ruche liee directement au Storage Controller (pas relay)
- +1 slot essence par hive connectee (4 base + max 4 bonus = 8 total)
- 3 etats visuels: UNLINKED, LINKED, ACTIVE
- Delivery bees dynamiques: base 2 + sum(tiers des hives)
- Consommation miel multiplicative entre hives

SCRIPTS CREES (2):
- common/block/storage/StorageHiveBlock.java
- common/blockentity/storage/StorageHiveBlockEntity.java

SCRIPTS MODIFIES (12):
- StorageControllerBlockEntity, StorageNetworkRegistry, StorageEvents
- ControllerStats, StorageDeliveryManager, StorageMultiblockManager
- StorageControllerMenu, StorageControllerScreen
- BeemancerBlocks, BeemancerItems, BeemancerBlockEntities, BeemancerCreativeTabs

ASSETS: 3 blockstates, 9 block models, 3 item models, 3 loot tables, lang

================================================================================
2026-02-07 - Honeyed Logs/Wood + Placeable Crystals + Texture Cleanup
================================================================================

NOUVEAUX BLOCS HONEYED (6):
- honeyed_log: RotatedPillarBlock (cube_column, side=honeyed_wood, end=honeyed_wood_top_bottom)
- stripped_honeyed_log: RotatedPillarBlock (cube_column, stripped textures)
- honeyed_wood: RotatedPillarBlock (cube_column, bark on all faces)
- stripped_honeyed_wood: RotatedPillarBlock (cube_column, stripped bark all faces)
- honeyed_wood_stair: StairBlock
- honeyed_wood_slab: SlabBlock

CRISTAUX POSABLES (2):
- royal_crystal: HoneyCrystalBlock (cross model, cutout, light 10, amethyst sound)
- nectar_crystal: HoneyCrystalBlock (idem)
- Convertis de Item simple vers BlockItem wrapping un bloc HoneyCrystalBlock
- Pattern identique a honey_crystal (VoxelShape 3-13, cross model)

SUPPRESSION ITEM HONEYED_WOOD (alchimie):
- Item honeyed_wood supprime (etait ingredient alchimie)
- Remplace par honeyed_log dans 6 recettes:
  infusing/honeyed_log.json, crafting/honey_pipe.json, crafting/honey_pipe_tier2.json,
  crafting/multiblock_tank.json, crafting/infuser_tier2.json, crafting/honeyed_planks.json

NETTOYAGE TEXTURES (35 supprimees):
- 19 textures orphelines racine (export_interface, iron_incubator, lamp, etc.)
- 13 textures orphelines alchemy/ (crystallizer_*, infuser_*, honey_tank_*, etc.)
- 1 texture doublon honeyed/ (honeywood.png)
- 2 textures orphelines logistic/ (storage_terminal*.png)

REORGANISATION TEXTURES (27 deplacees):
- 7 textures vers building/ (honeyed_plank, honeyed_glass*, nectar_planks, etc.)
- 9 textures vers machines/ (bee_creator, bee_statue_*, incubator, etc.)
- 6 textures vers altar/ (honeyed_stone, honey_crystal*, honey_pedestal_*)
- 1 texture vers storage/ (storage_crate)
- 3 textures vers pipes/ (honey_pipe, pipe_core_white, pipe_frame)
- Fusion logistic/ dans storage/ (storage_controller.png), dossier logistic/ supprime

MODELES REORGANISES:
- honeyed_iron_block.json deplace vers building/
- Tous les model JSON mis a jour avec les nouveaux chemins textures

ASSETS CREES:
- 6 blockstates (honeyed_log, stripped_honeyed_log, honeyed_wood, stripped_honeyed_wood,
  royal_crystal, nectar_crystal)
- 8 models block (honeyed_log, _horizontal, stripped_honeyed_log, _horizontal,
  honeyed_wood, stripped_honeyed_wood, royal_crystal, nectar_crystal)
- 6 models item (honeyed_log, stripped_honeyed_log, honeyed_wood, stripped_honeyed_wood + existants)

CREATIVE TAB:
- Ajout 4 honeyed logs/wood dans addBuildingBlocks()

REGISTRES MODIFIES:
- BeemancerBlocks: +HONEYED_LOG, +STRIPPED_HONEYED_LOG, +HONEYED_WOOD, +STRIPPED_HONEYED_WOOD,
  +HONEYED_WOOD_STAIR, +HONEYED_WOOD_SLAB, +ROYAL_CRYSTAL, +NECTAR_CRYSTAL
- BeemancerItems: +6 BlockItems logs/wood, ROYAL_CRYSTAL et NECTAR_CRYSTAL convertis Item->BlockItem,
  -HONEYED_WOOD (item alchimie)
- BeemancerCreativeTabs: +4 honeyed bois dans building

================================================================================
2026-02-06 - Multiblock IO Config System + Centrifuge IO Inversion
================================================================================

SYSTÈME IO DÉCLARATIF (3 nouveaux fichiers):
- IOMode.java: enum NONE/INPUT/OUTPUT/BOTH avec allowsInput()/allowsOutput()
- BlockIORule.java: règles IO per-face (EnumMap<Direction, IOMode>), builder + factories
  (allFaces, sides), configurable via .face()/.sides()/.up()/.down()
- MultiblockIOConfig.java: config IO complète mappant Vec3i offsets → BlockIORule
  pour fluid et item, avec lookup getFluidMode()/getItemMode()

FACTORIES UNIDIRECTIONNELLES:
- SplitFluidHandler: +inputOnly(FluidTank) — fill only, drain blocked
- SplitFluidHandler: +outputOnly(FluidTank) — drain only, fill blocked
- SplitItemHandler: +inputOnly(IItemHandler) — insert only, extract blocked
- SplitItemHandler: +outputOnly(IItemHandler) — extract only, insert blocked

CENTRIFUGE HEART:
- Migration vers IO_CONFIG déclaratif (remplace face filtering hardcodé)
- Inversion entrées/sorties: TOP (Y+1) = INPUT (miel+items), BOTTOM (Y-1) = OUTPUT (produits)
- Vitesse rotation animation: 8.0 → 12.0 (×1.5)
- Suppression debug logging (3 LOGGER.warn dans getFluidHandlerForBlock)

ALEMBIC HEART:
- Implémente MultiblockCapabilityProvider (nouveau)
- IO_CONFIG: heart per-face (DOWN=nectar OUTPUT, UP=royal jelly INPUT, SIDES=honey INPUT)
- Réservoirs: bas=nectar OUTPUT, gauche=honey INPUT, droit=royal jelly INPUT
- linkReservoirControllers(): lie/délie réservoirs au contrôleur
- invalidateAllCapabilities(): force NeoForge à re-query les capabilities
- onMultiblockFormed/Broken: link → blockstates → invalidate (ordre correct)

BEEMANCER.java:
- ALEMBIC_HEART fluid: délègue via getFluidHandlerForBlock quand formé
- INFUSER_HEART item: nouvelle capability (DOWN=outputOnly, autres=inputOnly)
- HONEY_RESERVOIR: suppression debug logging

FICHIERS CRÉÉS (3):
- core/multiblock/IOMode.java
- core/multiblock/BlockIORule.java
- core/multiblock/MultiblockIOConfig.java

FICHIERS MODIFIÉS (5):
- core/util/SplitFluidHandler.java (+inputOnly, +outputOnly, -debug import)
- core/util/SplitItemHandler.java (+inputOnly, +outputOnly)
- common/blockentity/alchemy/CentrifugeHeartBlockEntity.java (IO_CONFIG, inversion, rotation)
- common/blockentity/alchemy/AlembicHeartBlockEntity.java (+MultiblockCapabilityProvider)
- Beemancer.java (Alembic delegation, Infuser item cap, -debug logs)

================================================================================
2026-02-06 - Multiblock Capability Delegation + Codex Book Features
================================================================================

MULTIBLOCK CAPABILITY DELEGATION:
- Nouveau: MultiblockCapabilityProvider interface (core/multiblock/)
- Nouveau: SplitFluidHandler (fill→inputTank, drain→outputTank)
- Nouveau: SplitItemHandler (insertItem→input, extractItem→output)
- Modifié: HoneyReservoirBlockEntity — controllerPos + findCapabilityProvider()
- Modifié: CentrifugeHeartBlockEntity — implements MultiblockCapabilityProvider
- Modifié: Beemancer.java — capability registration fluid+item pour reservoir+heart
- Les pipes fluide/item se connectent aux réservoirs et délèguent au coeur

CODEX BOOK:
- Nouveau: StickyNote record (title, color) + parsing JSON sticky_notes
- Modifié: CodexBookContent — champ stickyNotes
- Modifié: CodexBookScreen — boutons sticky note (droite du livre) + overlay
- Modifié: meadow_bee.json — 3 sticky notes de test (Habitat, Breeding, Tips)

CENTRIFUGE:
- Nouveau: centrifuge_heart_centrifuge_working.json (texture honey_crystal)
- Modifié: blockstates/centrifuge_heart.json — working=true pointe vers working model
- Modifié: PoweredCentrifugeMenu — filtre par tag beemancer:combs

CODEX DECORATIONS:
- CodexDecorationRenderer revu pour suivre le scroll (coordonnées relatives)
- atlases/blocks.json créé pour texture empty_slot_comb

================================================================================
2026-02-05 - Bugfixes + Optimisations Reseau de Stockage
================================================================================

Corrections de bugs dans le systeme de livraison et optimisations de routing.

BUGFIXES:
- Interface detruite: override setRemoved() pour annuler les demandes et rappeler
  les abeilles en vol (cancelRequestsFromRequester via requesterPos)
- Interface toggle off: setActive(false) annule maintenant les demandes existantes
- Mauvais relay: ajout requesterPos sur DeliveryTask pour identifier le bon relay
  quand 2 interfaces pointent sur le meme bloc adjacent
  Supprime findAdjacentRegisteredBlock (approche flawed)
- Validation periodique des sources: RequestManager.validateRequestSources() verifie
  toutes les 100 ticks que les interfaces emettrices existent et sont actives
- Placement intelligent: processExportRequest utilise findSlotForItem (5 priorites)
  au lieu de findChestWithSpace (scan lineaire)

OPTIMISATION ROUTING:
- Supprime la phase FLY_TO_CONTROLLER: les abeilles passent directement de la source
  a la destination via le relay ancetre commun (algorithme LCA)
- computeTransitWaypoints(): calcule le chemin transit source→dest en trouvant le
  prefixe commun des chemins controller→source et controller→dest
- Waypoints reorganises: outbound (→source), transit (source→dest), home (dest→controller)
- Supprime returnWaypoints/destWaypoints, remplace par transitWaypoints/homeWaypoints

DEBUG:
- DeliveryBeeRenderer affiche la phase courante (FLY_TO_SOURCE, FLY_TO_DEST, etc.)
  au-dessus de la tete quand DebugWandItem.displayDebug est actif
- Texte jaune avec fond semi-transparent, billboard face camera, SEE_THROUGH

FICHIERS MODIFIES (8):
- RequestManager.java: +cancelRequestsFromRequester(), +validateRequestSources(),
  utilise findSlotForItem pour export, import BlockEntity/Set/HashSet
- NetworkInterfaceBlockEntity.java: override setRemoved(), setActive() annule demandes
- DeliveryTask.java: +requesterPos (nullable), MAJ constructeurs/NBT/splitRemaining
- StorageDeliveryManager.java: findPathToChest accepte requesterPos hint,
  +computeTransitWaypoints() LCA, MAJ spawnDeliveryBee waypoints
- StorageNetworkRegistry.java: -findAdjacentRegisteredBlock()
- DeliveryBeeEntity.java: outbound/transit/home waypoints, +deliveryGoal getter,
  +setAllWaypoints()
- DeliveryPhaseGoal.java: -FLY_TO_CONTROLLER, Phase enum public, +getPhase(),
  transitIdx remplace returnIdx/destIdx
- DeliveryBeeRenderer.java: +render() override avec debug phase text

================================================================================
2026-02-04 - Phase 5: GUI Localization + Finalization
================================================================================

Phase finale du refactoring du systeme de livraison (5/5).

LOCALIZATION:
- getStateLabel() dans StorageTerminalScreen utilise maintenant des cles i18n
- Ajout cles gui.beemancer.tasks.state.* dans en_us.json et fr_fr.json
  (flying, queued, completed, failed)

CLEANUP:
- Supprime DeliveryState.WAITING et RETURNING (jamais utilises)
- Simplifie isActive() → verifie uniquement FLYING
- Supprime cases WAITING/RETURNING dans getStateColor/getStateLabel

FICHIERS MODIFIES (4):
- DeliveryTask.java: simplifie DeliveryState enum
- StorageTerminalScreen.java: localise state labels, supprime dead states
- en_us.json: ajout 4 cles state
- fr_fr.json: ajout 4 cles state

================================================================================
2026-02-04 - Phase 4: Fix Bee Identification + Recall Mechanism + Item Recovery
================================================================================

Refactoring Phase 4 du systeme de livraison (5 phases prevues).

BUGS FIXES:
- killBeeForTask identifiait les bees par template+count (fragile) → maintenant par taskId
- Items en vol perdus lors de l'annulation d'une tache active → maintenant restitues
- killAllDeliveryBees ne restituait pas les items transportes → maintenant oui

AJOUTS:
- DeliveryBeeEntity.recalled flag + recall() + isRecalled(): mecanisme de rappel
- DeliveryPhaseGoal.handleRecall(): vol direct vers returnPos, restitution items, discard
- recallBeeForTask() remplace killBeeForTask(): identification par taskId + recall au lieu de kill

FICHIERS MODIFIES (3):
- DeliveryBeeEntity.java: ajout recalled flag, recall(), isRecalled()
- DeliveryPhaseGoal.java: ajout handleRecall(), check isRecalled() dans tick()
- StorageDeliveryManager.java: killBeeForTask → recallBeeForTask (taskId), killAllDeliveryBees securise

COMPORTEMENT:
- Annulation tache en queue: tache retiree, aucune bee a rappeler
- Annulation tache active: bee rappellee, vole directement vers controller, restitue items, discard
- Destruction controller: toutes bees tuees immediatement avec restitution items

================================================================================
2026-02-04 - Phase 3: Suppression DeliveryType + Flux Unifié + Fix Terminal Export
================================================================================

Refactoring Phase 3 du système de livraison (5 phases prévues).

SUPPRESSIONS:
- DeliveryTask.DeliveryType enum (EXTRACT/DEPOSIT) supprimé
- DeliveryBeeEntity.deliveryType, needsTerminalFlight() supprimés
- Branches DEPOSIT dans DeliveryPhaseGoal supprimées
- TaskDisplayData.type field supprimé

RENOMMAGES:
- DeliveryTask: targetPos → sourcePos, terminalPos → destPos, originPos supprimé
- DeliveryBeeEntity: targetPos → sourcePos, terminalPos → destPos
- DeliveryBeeEntity: terminalWaypoints → destWaypoints, setTerminalWaypoints → setDestWaypoints
- DeliveryPhaseGoal phases: FLY_OUTBOUND → FLY_TO_SOURCE, WAIT_AT_TARGET → WAIT_AT_SOURCE,
  FLY_RETURN → FLY_TO_CONTROLLER, FLY_TO_TERMINAL → FLY_TO_DEST,
  WAIT_AT_TERMINAL → WAIT_AT_DEST, terminalIdx → destIdx

AJOUTS:
- DeliveryTask.preloaded: flag indiquant que les items sont pré-chargés sur la bee
- InterfaceRequest.preloaded: propagé depuis le terminal deposit
- DeliveryPhaseGoal: si preloaded, saute directement à FLY_TO_DEST (skip source)
- StorageDeliveryManager: spawnDeliveryBee pré-charge les items si task.isPreloaded()
- RequestManager.cancelRequest: remet items dans le réseau pour demandes preloaded non assignées

FIX BUG TERMINAL EXPORT:
- Avant: terminal retirait items du slot, publiait EXPORT, bee arrivait au terminal → rien à extraire → échec
- Après: terminal marque la request preloaded=true, bee spawn avec items pré-chargés, saute la source

FICHIERS MODIFIÉS (8):
- DeliveryTask.java: supprimé DeliveryType, renommé champs, ajouté preloaded
- DeliveryBeeEntity.java: supprimé deliveryType, renommé champs/waypoints
- DeliveryPhaseGoal.java: renommé phases, supprimé branches DEPOSIT, géré preloaded
- StorageDeliveryManager.java: adapté spawn/cancel/validate/blockedReason au flux unifié
- RequestManager.java: adapté constructeurs DeliveryTask, géré preloaded cancel
- StorageTerminalBlockEntity.java: marqué exports preloaded=true
- TaskDisplayData.java: supprimé champ type, adapté serialisation
- StorageTerminalScreen.java: remplacé indicateur type par indicateur origin

NBT BACKWARDS COMPAT:
- DeliveryTask.load: accepte SourcePos/TargetPos/TargetChest et DestPos/TerminalPos

================================================================================
2026-02-04 - Phase 2: Système de Demandes (InterfaceRequest + RequestManager)
================================================================================

Refactoring Phase 2 du système de livraison (5 phases prévues).

ARCHITECTURE ENTITÉS:
- InterfaceRequest: demande publiée par interfaces/terminaux (item, quantité, source, type)
- RequestManager: gestionnaire central des demandes attaché au StorageController

FICHIERS CRÉÉS (2):
- common/block/storage/InterfaceRequest.java: classe simple immutable
- common/blockentity/storage/RequestManager.java: registre + résolution demandes

FICHIERS MODIFIÉS (6):
- ImportInterfaceBlockEntity: publie InterfaceRequest au lieu de créer DeliveryTask directement
- ExportInterfaceBlockEntity: publie InterfaceRequest au lieu de créer DeliveryTask directement
- StorageTerminalBlockEntity: requestItem() et tryDepositToNetwork() publient InterfaceRequest
- StorageControllerBlockEntity: ajout RequestManager (field, tick, NBT, accesseur)
- StorageDeliveryManager: finishTask notifie RequestManager (onTaskCompleted/onTaskFailed)
- NetworkInterfaceBlockEntity: suppression pendingTasks (remplacé par RequestManager)
  - unlinkTerminal/unlinkInterface annulent les demandes via cancelRequestsFromSource()

NBT BACKWARDS COMPAT:
- RequestManager sauvegarde/charge queue via "Requests" (List de requêtes)
- NetworkInterfaceBlockEntity: "PendingTasks" deprecated mais toujours chargé

INTÉGRATION COMPLÈTE:
- Cycle: Interface → InterfaceRequest → RequestManager → StorageDeliveryManager
- RequestManager valide, ordonnance, et annule demandes centralement
- Tous les types de demandes (Import/Export/Terminal) passent par le même système

================================================================================
2026-02-04 - Phase 1: Nettoyage Delivery System + ContainerHelper
================================================================================

Refactoring Phase 1 du systeme de livraison (5 phases prevues).

1. DEAD CODE REMOVAL
- DeliveryTask: suppression champ assignedBeeId (jamais lu avec valeur non-null)
- DeliveryTask: suppression getter/setter/NBT pour assignedBeeId
- StorageDeliveryManager: suppression setAssignedBeeId(null) et taskTag.remove("AssignedBeeId")
- StorageControllerBlockEntity: migrateOldNetworkData() marquee @Deprecated

2. EXTRACTION ContainerHelper (core/util/ContainerHelper.java) — NOUVEAU
- insertItem(Container, ItemStack) / insertItem(Container, ItemStack, int[])
- extractItem(Container, ItemStack, int)
- countItem(Container, ItemStack) / countItem(Container, ItemStack, int[])
- hasSpaceFor(Container, ItemStack, int)
- availableSpace(Container, ItemStack)

Fichiers refactores:
- StorageDeliveryManager: depositIntoChest, extractItemForDelivery, countItemInChest,
  findChestWithItem, findChestWithSpace → utilisent ContainerHelper
- DeliveryPhaseGoal: depositIntoContainer, hasSpaceForItem → utilisent ContainerHelper
- ImportInterfaceBlockEntity: insertIntoSlots, countInSlots → utilisent ContainerHelper
- StorageItemAggregator: depositItem, extractItem → utilisent ContainerHelper

3. MERGE completeTask/failTask → finishTask
- StorageDeliveryManager: nouvelle methode privee finishTask(UUID, DeliveryState)
- completeTask() et failTask() delegent a finishTask()

4. EXTRACTION NAVIGATION HELPER (DeliveryPhaseGoal)
- Nouvelle methode navigateWaypoints(List<BlockPos>, int[], BlockPos) → boolean
- tickFlyOutbound, tickFlyReturn, tickFlyToTerminal, tickFlyHome simplifies
- Remplacement de 4x ~20 lignes par 4x ~5 lignes + 1x helper ~25 lignes

5. FIX BUG container.setChanged()
- ImportInterfaceBlockEntity.insertIntoSlots: condition incorrecte
  (remaining.getCount() != remaining.getMaxStackSize()) corrigee par
  remplacement total via ContainerHelper.insertItem()

================================================================================
2026-02-04 - Export Relay Routing + Import Item Validation + Task Blocked Status
================================================================================

Corrections de 3 bugs majeurs sur le systeme de livraison.

1. EXPORT BEES NE PASSENT PAS PAR LES RELAYS
- DeliveryTask: +champ originPos (nullable, NBT compat) pour tracer l'interface source
- ExportInterfaceBlockEntity: passe worldPosition comme originPos
- StorageDeliveryManager.spawnDeliveryBee(): fallback findPathToOwnerNode(originPos)
  quand findPathToChest(targetPos) echoue

2. IMPORT CREE DES TACHES SANS VERIFIER LA DISPONIBILITE
- ImportInterfaceBlockEntity: findChestWithItem(item, needed) au lieu de (item, 1)
  avec fallback + ajustement du count reel via countItemInChest()
- StorageDeliveryManager.spawnDeliveryBee(): re-validation EXTRACT au spawn,
  ajuste le count ou fail si items disparus
- StorageDeliveryManager: +countItemInChest()
- StorageControllerBlockEntity: +delegation countItemInChest()

3. AFFICHAGE RAISON DE BLOCAGE DES TACHES
- TaskDisplayData: +champ blockedReason (String, network encode/decode)
- StorageDeliveryManager: +computeBlockedReason() (honey, bees, dependency, items, space, target)
- StorageTerminalScreen: affiche raison sous la ligne de tache en rouge
- TASK_ROW_HEIGHT: 18 → 26, maxVisible: 8 → 6
- Lang en_us/fr_fr: 6 cles de blocage

FICHIERS MODIFIES (9):
- DeliveryTask.java: +originPos, constructeurs, NBT, splitRemaining
- StorageDeliveryManager.java: +countItemInChest, relay fallback, spawn validation, computeBlockedReason
- StorageControllerBlockEntity.java: +delegation countItemInChest
- ExportInterfaceBlockEntity.java: passe originPos
- ImportInterfaceBlockEntity.java: verification count reel
- TaskDisplayData.java: +blockedReason
- StorageTerminalScreen.java: rendu blocked reason, row height 26
- Lang en_us/fr_fr: +6 cles blocked

================================================================================
2026-02-04 - Delivery Bee Validation + Import Slot Fix + Edit Mode Fix + Alembic Layers
================================================================================

Corrections majeures sur les abeilles de livraison, import interface, edit mode et alembic.

1. DELIVERY BEE TURN-AROUND VALIDATION
- DeliveryBeeEntity: returnCarriedItemsToNetwork() et notifyTaskFailed() rendus public
- DeliveryPhaseGoal: tickWaitAtTarget() abort si extraction vide ou depot echoue
- DeliveryPhaseGoal: tickWaitAtTerminal() verifie isTerminalValid() avant livraison
- isTerminalValid(): verifie interface active, linkee, inventaire adjacent existant
- hasSpaceForItem(): verifie espace disponible dans container destination

2. IMPORT INTERFACE SLOT TARGETING FIX
- ImportInterfaceBlockEntity.receiveDeliveredItems(): utilise les slots du filtre matching
  au lieu de l'union de tous les filtres (corrige items dans mauvais slots + bug quantite)
- NetworkInterfaceBlockEntity.getAdjacentInventory() passe de protected a public

3. TERMINAL GUI Z-ORDERING
- StorageTerminalScreen.renderVirtualGrid(): 2 phases (items puis texte a z=200)
- StorageTerminalScreen.renderRequestPopup(): panneau a z=400, texte a z=600

4. EDIT MODE FIXES
- StorageEvents: interface/terminal click droit hors shift en edit mode = toggle link/unlink
- StorageEvents: +onBlockBreak() pour deregistrer les blocs casses du registre
- ImportInterfaceBlock/ExportInterfaceBlock/StorageTerminalBlock: onRemove deregistre du
  StorageNetworkRegistry
- StorageNetworkRegistry: +getEntry(BlockPos)

5. ALEMBIC RESERVOIR MODEL LAYERS
- MultiblockProperty: +ALEMBIC_0, +ALEMBIC_1
- HoneyReservoirBlock: MULTIBLOCK property inclut alembic_0, alembic_1
- AlembicHeartBlockEntity.setFormedOnStructureBlocks(): layer-aware (Y-1=ALEMBIC_0, Y+0=ALEMBIC_1)
- Blockstate honey_reservoir.json: +8 variants (alembic_0/alembic_1 x 4 facings)
- Modeles: honey_reservoir_alembic_0.json, honey_reservoir_alembic_1.json

6. UI: TOGGLE BUTTON REPOSITIONNE
- NetworkInterfaceScreen: bouton toggle deplace a droite sous "Linked"/"Not Linked"

FICHIERS MODIFIES (16):
- DeliveryBeeEntity.java: methodes public
- DeliveryPhaseGoal.java: +isTerminalValid(), +hasSpaceForItem(), abort logic
- ImportInterfaceBlockEntity.java: receiveDeliveredItems() per-filter slots
- NetworkInterfaceBlockEntity.java: getAdjacentInventory() public
- NetworkInterfaceScreen.java: toggle button repositionne
- StorageTerminalScreen.java: z-ordering grid + popup
- StorageEvents.java: toggle link/unlink, +onBlockBreak()
- ImportInterfaceBlock.java: onRemove unregister
- ExportInterfaceBlock.java: onRemove unregister
- StorageTerminalBlock.java: onRemove unregister
- StorageNetworkRegistry.java: +getEntry()
- MultiblockProperty.java: +ALEMBIC_0, +ALEMBIC_1
- HoneyReservoirBlock.java: MULTIBLOCK +alembic_0, +alembic_1
- AlembicHeartBlockEntity.java: layer-aware setFormedOnStructureBlocks
- honey_reservoir.json (blockstate): +alembic_0/alembic_1 variants
- honey_reservoir_alembic_0.json, honey_reservoir_alembic_1.json (modeles)
- Lang en_us/fr_fr: +unlinked messages

================================================================================
2026-02-04 - Fix Import/Export Quantite + Fix Interface Pathfinding + Toggle Active
================================================================================

Correction de 3 bugs sur les Import/Export Interfaces:

BUG 1: Import/Export enchainait les taches au lieu de respecter la quantite
- pendingTasks passe de Map<String, UUID> a Map<String, PendingTaskInfo>
- PendingTaskInfo record contient taskId + count
- getPendingCount() verifie si la tache existe toujours et retourne le count
- Import: needed -= pendingCount (scanItemMode + scanTextMode)
- Export: exportable -= pendingExportCount
- NBT backwards compat: "Count" absent → default 1

BUG 2: Interface pathfinding ignorait les relays
- Ajout findPathToOwnerNode() utilisant StorageNetworkRegistry.getOwner()
- findPathToChest() essaie d'abord NetworkRegistry avant le BFS par chests
- Suppression de findPathToPosition() (fallback distance avec seuil 15 blocs)
- Les interfaces sont maintenant routees via leur relay proprietaire

BUG 3: Toggle d'activation sur les interfaces
- Champ active (defaut false) avec getter/setter + NBT
- ACTION_TOGGLE_ACTIVE (8) dans InterfaceActionPacket
- serverTick() skip le scan si !active
- Bouton ON/OFF vert/rouge dans NetworkInterfaceScreen

FICHIERS MODIFIES (7):
- NetworkInterfaceBlockEntity.java: +PendingTaskInfo, +active, +getPendingCount(), NBT
- InterfaceActionPacket.java: +ACTION_TOGGLE_ACTIVE (8), handler
- ImportInterfaceBlockEntity.java: needed -= pendingCount (2 sites)
- ExportInterfaceBlockEntity.java: exportable -= pendingExportCount
- StorageDeliveryManager.java: +findPathToOwnerNode(), findPathToChest() refacto,
  -findPathToPosition(), spawnDeliveryBee() simplifie
- NetworkInterfaceScreen.java: +bouton ON/OFF toggle, renderStatus + mouseClicked
- Lang en_us/fr_fr: +gui.beemancer.interface.active/inactive

================================================================================
2026-02-04 - Refacto DeliveryTask: TaskOrigin + GUI Requests/Automation
================================================================================

Ajout de TaskOrigin (REQUEST/AUTOMATION) aux taches de livraison.
Rename targetChest → targetPos. GUI Tasks separe en deux sections.

FICHIERS MODIFIES (8):
- DeliveryTask.java: +enum TaskOrigin (REQUEST/AUTOMATION), +champ origin,
  rename targetChest→targetPos, constructeurs mis a jour, NBT backwards compat
- TaskDisplayData.java: +champ origin dans le record, toNetwork/fromNetwork
- StorageDeliveryManager.java: taskToDisplayData +origin, rename getTargetChest→getTargetPos
- ImportInterfaceBlockEntity.java: 2 sites → TaskOrigin.AUTOMATION
- ExportInterfaceBlockEntity.java: 1 site → TaskOrigin.AUTOMATION
- StorageTerminalBlockEntity.java: 3 sites → TaskOrigin.REQUEST
- StorageTerminalScreen.java: renderTasksTab split Requests/Automation,
  +renderTaskRow(), +getTotalTaskEntries(), +checkCancelClick()
- Lang en_us/fr_fr: tasks.requests, tasks.automation (remplace tasks.active/queued)

NBT BACKWARDS COMPAT:
- "TargetChest" lu en fallback si "TargetPos" absent
- "Origin" absent → default REQUEST

================================================================================
2026-02-04 - Securite UUID Bee-Hive + Fix Velocite Sortie Ruche
================================================================================

Systeme de synchronisation UUID entre abeilles exterieures et leur ruche.
Elimine les doublons d'abeilles et corrige le bug de velocite a la sortie.

FICHIERS MODIFIES (3):
- HiveBeeLifecycleManager.java: +handleBeePing(), +verifyOutsideBees(),
  +resetSlotToInside(), canBeeEnter() + UUID check, releaseBee() + velocity fix
- MagicHiveBlockEntity.java: +outsideVerifyTimer, +handleBeePing() delegation,
  serverTick() verification periodique
- MagicBeeEntity.java: +hivePingTimer, +tickHivePing(), tick() appel ping

MECANISME:
- Bee ping ruche toutes les 2s (40 ticks) pour valider UUID
- UUID mismatch + slot OUTSIDE → doublon detruit
- UUID mismatch + slot INSIDE → adopte bee exterieur
- Ruche verifie ses OUTSIDE toutes les 2s, reset si entite absente
- canBeeEnter() exige UUID match
- setDeltaMovement(Vec3.ZERO) apres moveTo dans releaseBee()

================================================================================
2026-02-04 - Flywheel Test Bee (Proof of Concept GPU Instancing)
================================================================================

Systeme de test isole pour valider le rendu GPU instancie via Flywheel.
Entite test immobile, visual Flywheel avec animation ailes + bobbing, bloc spawner.

CLASSES JAVA CREEES (4):
- content/flywheeltest/FlywheelTestBeeEntity.java (Entity immobile, zero AI, speciesId synced)
- content/flywheeltest/BeeSpawnerBlock.java (Bloc spawner test, clic/shift+clic)
- client/visual/FlywheelTestBeeVisual.java (Visual Flywheel GPU, ailes + bobbing visuels)
- client/visual/FlywheelTestBeeVisualizer.java (Registration Flywheel)

CORRECTIONS POST-IMPLEMENTATION:
- Entity: supprime tick()/startY (bobbing server causait teleportation)
- Visual: bobbing deplace en visuel-only dans beginFrame()
- Visual: retire isVisible(frustum) (bloquait animation a proximite)
- Visual: frequence ailes acceleree (time * 2.5, amplitude 0.5 rad)

REGISTRES MODIFIES:
- BeemancerEntities: +FLYWHEEL_TEST_BEE
- BeemancerBlocks: +BEE_SPAWNER
- BeemancerItems: +BEE_SPAWNER (BlockItem)
- BeemancerCreativeTabs: +addFlywheelTest()
- ClientSetup: +NoopRenderer, +FlywheelTestBeeVisualizer

ASSETS CREES (4):
- blockstates/bee_spawner.json
- models/block/test/bee_spawner.json
- models/item/bee_spawner.json
- data/beemancer/loot_table/blocks/bee_spawner.json

LANG:
- en_us.json: +2 entrees (bee_spawner, flywheel_test_bee)
- fr_fr.json: +2 entrees

REVERT:
Supprimer 4 fichiers Java + 4 JSON + retirer lignes dans 5 registres + 4 lignes lang.

================================================================================
2026-02-04 - Multibloc Modeles Dedies + Suppression LAYER
================================================================================

Chaque bloc multibloc possede maintenant un modele JSON dedie par etat
multibloc forme. Suppression de la propriete LAYER du HoneyedStoneBlock.

CLASSES JAVA CREEES (3):
- common/block/building/HoneyedStoneWallBlock.java (WallBlock + MULTIBLOCK)
- common/block/building/HoneyedGlassBlock.java (TransparentBlock + MULTIBLOCK)
- common/block/building/RoyalGoldBlock.java (Block + MULTIBLOCK)

BLOCS JAVA MODIFIES (6):
- HoneyedStoneBlock: supprime LAYER, MULTIBLOCK etendu (altar,extractor,infuser,centrifuge,storage)
- HoneyReservoirBlock: MULTIBLOCK etendu (altar,extractor,storage,alembic)
- HoneyedStoneStairBlock: +MULTIBLOCK (altar)
- HoneyPedestalBlock: +MULTIBLOCK (altar,extractor)
- ControlledHiveBlock: +MULTIBLOCK (storage)
- StorageTerminalBlock: +MULTIBLOCK (storage)

BLOCKENTITES MODIFIES (6):
- AltarHeartBlockEntity: supprime LAYER, +updateGenericMultiblock pour stairs/pedestals
- ExtractorHeartBlockEntity: +setFormedOnStructureBlocks (EXTRACTOR)
- InfuserHeartBlockEntity: +setFormedOnStructureBlocks (INFUSER)
- CentrifugeHeartBlockEntity: +setFormedOnStructureBlocks (CENTRIFUGE)
- AlembicHeartBlockEntity: +setFormedOnStructureBlocks (ALEMBIC)
- StorageMultiblockManager: supprime skipMultiblock HoneyedStone

REGISTRE BeemancerBlocks.java:
- HONEYED_STONE_WALL: WallBlock → HoneyedStoneWallBlock
- HONEYED_GLASS: TransparentBlock → HoneyedGlassBlock
- ROYAL_GOLD_BLOCK: Block → RoyalGoldBlock

BLOCKSTATE JSONs MODIFIES (10):
- honeyed_stone, honey_reservoir, hive_multiblock, honeyed_slab,
  honeyed_stone_stair, honey_pedestal, honeyed_glass, royal_gold_block,
  controlled_hive, storage_terminal

MODELES JSON CREES (21): copies de base pour chaque etat multibloc forme
MODELES JSON SUPPRIMES (3): honeyed_stone_altar_layer0/1/2.json

================================================================================
2026-02-04 - Multibloc Blockstate Refonte + New Alchemy Heart Blocks
================================================================================

Remplacement de BooleanProperty FORMED par EnumProperty<MultiblockProperty>
MULTIBLOCK sur tous les blocs multiblocs. Ajout de 3 Heart blocks alchemy
et 3 blocs de stockage matériau.

SYSTÈME MULTIBLOCK PROPERTY:
- MultiblockProperty enum: NONE, ALTAR, EXTRACTOR, STORAGE, HIVE, ALEMBIC,
  INFUSER, CENTRIFUGE
- Remplace BooleanProperty FORMED sur 16 blocs
- Chaque bloc sait à quel multibloc il appartient quand formé

FICHIERS CRÉÉS (7):

1. core/multiblock/MultiblockProperty.java
   - Enum implémentant StringRepresentable
   - Factory method createProperty() retournant EnumProperty<MultiblockProperty>
   - Valeurs: NONE, ALTAR, EXTRACTOR, STORAGE, HIVE, ALEMBIC, INFUSER, CENTRIFUGE

2. common/block/alchemy/AlembicHeartBlock.java
   - Heart block pour multibloc Alembic
   - BlockState: MULTIBLOCK (none/alembic)

3. common/block/alchemy/InfuserHeartBlock.java
   - Heart block pour multibloc Infuser
   - BlockState: MULTIBLOCK (none/infuser)

4. common/block/alchemy/CentrifugeHeartBlock.java
   - Heart block pour multibloc Centrifuge
   - BlockState: MULTIBLOCK (none/centrifuge)

5. common/blockentity/alchemy/AlembicHeartBlockEntity.java
   - BlockEntity minimal pour Alembic Heart

6. common/blockentity/alchemy/InfuserHeartBlockEntity.java
   - BlockEntity minimal pour Infuser Heart

7. common/blockentity/alchemy/CentrifugeHeartBlockEntity.java
   - BlockEntity minimal pour Centrifuge Heart

BLOCS SIMPLES AJOUTÉS (3):
- honeyed_iron_block, royal_gold_block, nectar_diamond_block

FICHIERS MODIFIÉS (~30+):
- 16 blocs: altar_heart, extractor_heart, honey_pedestal, honeyed_stone,
  honeyed_stone_stair, honey_crystal_conduit, honey_reservoir, honeyed_slab,
  hive_multiblock, storage_controller, controller_pipe, storage_terminal,
  controlled_hive (FORMED → MULTIBLOCK enum)
- Tous les BlockEntities associés (formation/destruction code)
- Tous les renderers associés
- Tous les blockstate JSONs (formed=true/false → multiblock=none/xxx)

REGISTRES:
- BeemancerBlocks: +ALEMBIC_HEART, +INFUSER_HEART, +CENTRIFUGE_HEART,
  +HONEYED_IRON_BLOCK, +ROYAL_GOLD_BLOCK, +NECTAR_DIAMOND_BLOCK
- BeemancerItems: +6 BlockItems correspondants
- BeemancerBlockEntities: +ALEMBIC_HEART, +INFUSER_HEART, +CENTRIFUGE_HEART

================================================================================
2026-02-03 - Pollen Pot: refonte rendu (BlockEntityRenderer + textures)
================================================================================

Remplacement du système tintindex/BlockColor par un BlockEntityRenderer
qui affiche un cube texturé (concrete powder) dont la hauteur monte avec
le remplissage.

FICHIERS CRÉÉS (2):
- client/color/PollenTextures.java — mapping pollen → texture ResourceLocation
- client/renderer/block/PollenPotRenderer.java — BER avec FluidCubeRenderer
- assets/beemancer/textures/pollen_textures.json — données JSON du mapping

FICHIERS MODIFIÉS (2):
- client/ClientSetup.java — +enregistrement BER, -block color pollen pot
- models/block/machines/pollen_pot.json — suppression élément Inside (tintindex)

FICHIER SUPPRIMÉ (1):
- client/color/PollenColors.java — remplacé par PollenTextures

================================================================================
2026-02-02 - Particle System: utilitaire statique de particules
================================================================================

Création de ParticleHelper.java dans core/util/ — classe utilitaire statique
pour spawner des particules côté serveur et client.

FICHIER CRÉÉ (1):
- core/util/ParticleHelper.java
  - EffectType enum: 11 types prédéfinis (SUCCESS, FAILURE, MAGIC, HEAL, HONEY,
    SOUL, PORTAL, NATURE, FLAME, ELECTRIC, SCULK)
  - Formes géométriques: burst, ring, spiral, line, sphere
  - 3 niveaux de surcharge: EffectType, ParticleOptions, ResourceLocation
  - Client-side: addParticle, addAlwaysVisible
  - Résolution ResourceLocation via BuiltInRegistries.PARTICLE_TYPE

================================================================================
2026-02-01 - PlayerInventoryWidget: refactorisation complète des 10 écrans
================================================================================

Refactorisation majeure du système d'affichage d'inventaire joueur. Le widget
PlayerInventoryWidget utilise désormais un paramètre startY (texture position
from container top) au lieu de invY. Tous les 10 écrans restructurés: container
background réduit à la zone machine (via renderContainerBackgroundNoTitle) avec
4px gap avant le widget inventaire.

WIDGET CRÉÉ (1):
- client/gui/widget/PlayerInventoryWidget.java
  - Utilise textures/gui/inventory.png comme background
  - Paramètre startY pour position texture depuis le haut du container
  - Remplace les appels à GuiRenderHelper.renderPlayerInventory()
  - Rendu texture-based via blit pour un rendu plus fidèle

ASSET CRÉÉ (1):
- textures/gui/inventory.png (background inventaire joueur)

ÉCRANS REFACTORISÉS (10) — CHANGEMENTS STRUCTURE:

Standard (8 screens) — imageHeight: 166→170, machine box height: 76px
- AlembicScreen, InfuserScreen, ManualCentrifugeScreen,
  PoweredCentrifugeScreen, HoneyTankScreen, CreativeTankScreen,
  CrystallizerScreen, MultiblockTankScreen
- Slot Y positions: standard 84→88 (input/output), 142→146 (crafting/fuel)

MagicHive (1 screen) — imageHeight: 190→194, machine box height: 100px
- MagicHiveScreen
- Slot Y positions: 108→112 (input), 166→170 (output)

Hive (1 screen) — standard refactorisation
- IncubatorScreen
- Slot Y positions: 84→88 (input), 142→146 (output)

MENUS MODIFIÉS (9):
- ManualCentrifugeMenu, PoweredCentrifugeMenu, AlembicMenu, InfuserMenu,
  CrystallizerMenu, HoneyTankMenu, MultiblockTankMenu, IncubatorMenu,
  MagicHiveMenu
- Slot Y positions mises à jour (+4px): 84→88/142→146 (standard),
  108→112/166→170 (MagicHive)

SUPPRESSION LABEL:
- Inventory label suppressed via inventoryLabelY=-999 (rendu via texture)
- La texture inventory.png inclut le label "Inventory"

================================================================================
2026-01-31 - Storage Terminal GUI Layout Refonte (v2)
================================================================================

Refonte complète du layout GUI du Storage Terminal:

1. LAYOUT DEUX PANNEAUX (258x230)
   - Panneau gauche: deposit 3x3, craft 3x3, result slot, pickup 3x3
   - Panneau droit: search + grille virtuelle 9x5 + scrollbar + inventaire joueur

2. ONGLETS VERTICAUX
   - Onglets S/T/C à gauche du panneau gauche (x=2)
   - renderVerticalTab() ajouté dans GuiRenderHelper
   - Onglet actif fusionne visuellement avec le panneau

3. SUPPRESSION FLÈCHE PROGRESSION
   - Retrait de renderProgressArrow() du rendu Storage tab
   - La méthode reste dans GuiRenderHelper (utilisée ailleurs)

4. SLOT VISIBILITY VIA isActive()
   - Remplacement du repositionnement Y=-9999 par isActive() override
   - 4 inner classes: TabSlot, OutputOnlyTabSlot, TabResultSlot, TabBeemancerSlot

Fichiers modifiés:
- StorageTerminalScreen.java (rewrite complet)
- StorageTerminalMenu.java (positions slots + inner classes)
- GuiRenderHelper.java (+renderVerticalTab)

================================================================================
2026-01-31 - Storage Terminal Overhaul (8 changements interconnectés)
================================================================================

Refonte complète du système Storage Terminal avec 8 améliorations:

1. FIX DELIVERY BEE COLLISION
   - DeliveryBeeEntity.java: ajout `this.noPhysics = true` dans tick()
   - Les abeilles conservent le pathfinding mais traversent les blocs
   - Corrige le bug où les abeilles ne pouvaient pas atteindre les coffres

2. PRIORITÉ DE DÉPÔT INTELLIGENTE
   - StorageItemAggregator.java: réécriture findSlotForItem() avec 4 niveaux
   - Même item exact > même item (slot vide) > même tag > même namespace > coffre libre

3. PICKUP SLOTS EN SORTIE UNIQUEMENT
   - StorageTerminalMenu.java: OutputOnlySlot (inner class) pour slots 9-17
   - mayPlace() retourne false, le joueur ne peut qu'extraire

4. CRAFTING TABLE DANS LE TERMINAL
   - StorageTerminalMenu.java: grille 3x3 (slots 18-26) + ResultSlot (slot 27)
   - TransientCraftingContainer + recalcul recette via slotsChanged()
   - Drop des items de crafting à la fermeture du menu

5. 3 ONGLETS DANS LE TERMINAL
   - StorageTab.java (NOUVEAU): enum STORAGE, TASKS, CONTROLLER
   - Slots repositionnés à y=-9999 quand leur onglet n'est pas actif
   - GuiRenderHelper.java: ajout renderTab(), renderTabBar(), renderButton()

6. ONGLET TASKS (liste des tâches avec annulation)
   - TaskDisplayData.java (NOUVEAU): record avec taskId, template, count, state, type, dependencyIds
   - StorageTasksSyncPacket.java (NOUVEAU): Server→Client sync des tâches
   - StorageTaskCancelPacket.java (NOUVEAU): Client→Server annulation par UUID
   - StorageDeliveryManager.java: cancelTask(), cancelDependentTasks(), getTaskDisplayData()
   - StorageControllerBlockEntity.java: délégation cancelTask(), getTaskDisplayData()
   - Affichage avec connecteurs L pour les dépendances, bouton X pour annuler

7. ONGLET CONTROLLER (stats + essences)
   - ContainerData étendu à 11 valeurs (+ activeTaskCount, queuedTaskCount)
   - Essence slots (28-31) accessibles depuis le terminal
   - Affichage stats: flight/search/craft speed, quantity, honey, efficiency

8. GUI PROGRAMMATIQUE COMPLÈTE
   - StorageTerminalScreen.java: réécriture complète (230x280)
   - Rendu 100% programmatique avec GuiRenderHelper (pas de texture)
   - Grille virtuelle 9x5 avec scroll, search box, 3 zones de slots

FICHIERS CRÉÉS (4):
- client/gui/screen/storage/StorageTab.java
- common/block/storage/TaskDisplayData.java
- core/network/packets/StorageTasksSyncPacket.java
- core/network/packets/StorageTaskCancelPacket.java

FICHIERS MODIFIÉS (10):
- common/entity/delivery/DeliveryBeeEntity.java (noPhysics)
- common/blockentity/storage/StorageItemAggregator.java (priorité dépôt + task sync)
- common/menu/storage/StorageTerminalMenu.java (refonte complète)
- common/blockentity/storage/StorageTerminalBlockEntity.java (createMenu étendu)
- common/blockentity/storage/StorageDeliveryManager.java (cancel + display)
- common/blockentity/storage/StorageControllerBlockEntity.java (délégation)
- core/network/BeemancerNetwork.java (+2 packets)
- client/gui/GuiRenderHelper.java (tab rendering)
- client/gui/screen/storage/StorageTerminalScreen.java (refonte complète)
- lang/en_us.json + fr_fr.json (+10 clés traduction)

================================================================================
2026-01-31 - Suppression pollen/propolis/beeswax + Creative tab complète
================================================================================

Suppression des 3 items non désirés (pollen de base, propolis, beeswax) et
de toutes leurs références. Vérification et complétion de la creative tab.

ITEMS SUPPRIMÉS (3):
- BeemancerItems: POLLEN, PROPOLIS, BEESWAX

JAVA MODIFIÉS (3):
- BeemancerItems.java: suppression des 3 registrations
- BeemancerCreativeTabs.java: suppression des 3 items + ajout 5 manquants
  (CONTROLLED_HIVE, CONTROLLER_PIPE, CRANK, 8 shard fragments, 7 dust shards)
- PollenColors.java: suppression référence POLLEN

RECETTES MODIFIÉES (29):
- 26 centrifuge recipes: suppression pollen comme résultat (results: [])
- noble_comb.json: suppression pollen + beeswax
- diligent_comb.json: suppression pollen + propolis
- royal_comb.json: suppression propolis

LANG MODIFIÉS (2):
- en_us.json: suppression 3 item keys + 2 codex keys propolis
- fr_fr.json: idem

ASSETS MODIFIÉS (3):
- tags/item/pollens.json: suppression beemancer:pollen
- codex/alchemy.json: remplacement node propolis → bee_products
- CentrifugeRecipe.java: mise à jour exemple dans commentaire

CREATIVE TAB — ITEMS MANQUANTS AJOUTÉS (20):
- CONTROLLED_HIVE, CONTROLLER_PIPE (storage)
- CRANK (alchemy machines)
- 8 shard fragments (RAW_COPPER_FRAGMENT → GHAST_TEAR_FRAGMENT)
- 7 dust shards (DIAMOND_SHARD → NETHER_STAR_SHARD)

================================================================================
2026-01-31 - GUI Overhaul programmatique + Fixes (crank, centrifuge, tank)
================================================================================

4 changements majeurs dans cette session:

1. OVERHAUL GUI PROGRAMMATIQUE (10 screens)
   Conversion de tous les écrans containers du rendu texture vers rendu
   programmatique (GuiGraphics.fill()). Création de GuiRenderHelper.java
   (utilitaire partagé) utilisé par les 10 screens.

   JAVA CRÉÉ (1):
   - client/gui/GuiRenderHelper.java: background, slots, inventory, progress

   JAVA MODIFIÉS (10 screens):
   - MagicHiveScreen, IncubatorScreen, ManualCentrifugeScreen,
     PoweredCentrifugeScreen, HoneyTankScreen, CreativeTankScreen,
     MultiblockTankScreen, CrystallizerScreen, AlembicScreen, InfuserScreen

2. SUPPRESSION SONS ET PARTICULES CRANK
   - CrankBlock.java: suppression SoundEvents.WOOD_HIT
   - ManualCentrifugeBlock.java: suppression animateTick() (FALLING_HONEY)

3. FIX CENTRIFUGE PROCESSING
   - ManualCentrifugeBlockEntity.java: ajout findRecipe(), hasOutputSpace(),
     validation recette avant avancement progress, réécriture processInput()
   - ManualCentrifugeMenu.java: ajout filtre slot input (.withFilter())
   - honeycomb.json: recette vanilla honeycomb → pollen (50%) + 100mB honey

4. FIX MULTIBLOCK TANK DISCONNECT/RECONNECT
   - MultiblockTankBlockEntity.java: réécriture complète avec BFS flood-fill
     reformation (inspiré Create ConnectivityHandler). Suppression des méthodes
     mergeBlocksInto() et electNewMaster(). Ajout reformMultiblock() avec
     découverte BFS, élection master, collecte fluide, setup master/slaves.

================================================================================
2026-01-30 - Multiblock Tank: Apparence Honey Tank + Connexions visuelles
================================================================================

Refonte visuelle du Multiblock Fluid Tank pour ressembler au Honey Tank
(cadre + piliers + verre translucide) avec masquage des faces connectées
et rendu fluide par bloc individuel.

JAVA MODIFIÉS (3):
- MultiblockTankBlock.java: FORMED remplacé par 6 BooleanProperties (NORTH/SOUTH/
  EAST/WEST/UP/DOWN), updateShape() pour connexion automatique, getStateForPlacement()
- MultiblockTankBlockEntity.java: Supprimé MAJ blockstate FORMED dans
  recalculateStructure(), ajouté getFluidFillRatioForBlock() pour rendu par bloc
- MultiblockTankRenderer.java: Réécrit — chaque bloc rend son propre fluide selon
  sa position Y, face culling via propriétés de connexion

JAVA MODIFIÉ (1 utilitaire):
- FluidCubeRenderer.java: Ajouté surcharge avec 6 booléens de sélection de face

ASSETS CRÉÉS (13 modèles):
- models/block/alchemy/multiblock_tank/base.json (parent translucent)
- models/block/alchemy/multiblock_tank/frame_bottom.json (cadre bas)
- models/block/alchemy/multiblock_tank/frame_top.json (cadre haut)
- models/block/alchemy/multiblock_tank/pillar_nw.json (pilier NW)
- models/block/alchemy/multiblock_tank/pillar_ne.json (pilier NE)
- models/block/alchemy/multiblock_tank/pillar_sw.json (pilier SW)
- models/block/alchemy/multiblock_tank/pillar_se.json (pilier SE)
- models/block/alchemy/multiblock_tank/glass_north.json
- models/block/alchemy/multiblock_tank/glass_south.json
- models/block/alchemy/multiblock_tank/glass_east.json
- models/block/alchemy/multiblock_tank/glass_west.json
- models/block/alchemy/multiblock_tank/glass_up.json
- models/block/alchemy/multiblock_tank/glass_down.json

ASSETS MODIFIÉS (2):
- blockstates/multiblock_tank.json: multipart avec conditions de connexion
- models/block/alchemy/multiblock_tank.json: modèle complet pour item (style honey tank)

ASSETS SUPPRIMÉS (1):
- models/block/alchemy/multiblock_tank_formed.json

================================================================================
2026-01-30 - Refactorisation: split des 2 plus gros BlockEntity en managers
================================================================================

Extraction de managers avec back-reference (pattern Create/Mekanism) pour
améliorer la maintenabilité. NBT 100% compatible, API externe préservée.

FICHIERS CRÉÉS (5):

1. common/blockentity/storage/StorageChestManager.java (~158 lignes)
   - Gestion coffres enregistrés, BFS flood fill, toggle, range check
   - Champs: registeredChests
   - NBT: "RegisteredChests"

2. common/blockentity/storage/StorageItemAggregator.java (~367 lignes)
   - Agrégation items, dépôt, extraction, sync viewers, inner class ItemStackKey
   - Champs: aggregatedItems, syncTimer, needsSync, playersViewing
   - NBT: aucun (état runtime)

3. common/blockentity/storage/StorageDeliveryManager.java (~446 lignes)
   - Queue livraison, spawn bees, honey consumption, extract/deposit delivery
   - Champs: deliveryQueue, activeTasks, completedTaskIds, timers, honeyDepleted
   - NBT: "DeliveryQueue", "CompletedTaskIds", "HoneyDepleted"

4. common/blockentity/storage/StorageMultiblockManager.java (~243 lignes)
   - Formation/destruction multibloc, blockstate FORMED/FORMED_ROTATION updates
   - Champs: storageFormed, multiblockRotation
   - NBT: "StorageFormed", "MultiblockRotation"

5. common/block/hive/HiveBeeLifecycleManager.java (~258 lignes)
   - Release/entry abeilles, breeding auto, loot pollinisation, tick slots
   - Champs: aucun (opère via back-reference)
   - NBT: aucun

FICHIERS MODIFIÉS (2):

- StorageControllerBlockEntity.java: 1376→405 lignes
  Délègue à 4 managers, conserve inline: editMode, linkedTerminals, essenceSlots
  syncToClient() changé de private à package-private

- MagicHiveBlockEntity.java: 786→528 lignes
  Délègue à lifecycleManager, conserve: Container, NBT, flower management, helpers
  getSpeciesId() déplacé en static sur HiveBeeLifecycleManager

BILAN:
- ~1200 lignes extraites en managers spécialisés
- 5 nouveaux fichiers
- 2 fichiers simplifiés
- Zéro changement de comportement, NBT 100% compatible

================================================================================
2026-01-30 - Refactorisation: extraction classes utilitaires et base classes
================================================================================

Analyse complète du projet (231 fichiers, 38 419 lignes) et refactorisation
structurelle pour réduire la duplication et améliorer la maintenabilité.
Aucun changement de comportement.

FICHIERS CRÉÉS (5):

1. client/renderer/util/FluidCubeRenderer.java
   - Méthode statique renderFluidCube() extraite de 3 renderers identiques
   - Rendu d'un cube fluide avec 6 faces et 24 vertices

2. client/renderer/util/DebugRenderHelper.java
   - drawLine() et drawCubeOutline() extraits de BeeDebugRenderer et StorageControllerRenderer
   - Support Vec3 et float[] pour compatibilité avec les deux appelants

3. common/block/alchemy/AbstractPipeBlock.java
   - Base commune pour HoneyPipeBlock et ItemPipeBlock (étaient 95% identiques)
   - Contient: propriétés BlockState, VoxelShape cache, connexion, tinting, interactions
   - Template Method avec 8 méthodes abstraites pour les spécificités

4. common/menu/BeemancerMenu.java
   - Base classe pour tous les menus Beemancer
   - addPlayerInventory() et addPlayerHotbar() partagés par 10 menus

5. common/entity/bee/goal/MoveToTargetGoal.java
   - Classe interne extraite de MagicBeeEntity vers fichier autonome
   - Goal de navigation manuelle via BeeWand

FICHIERS MODIFIÉS (18):

Renderers fluide (→ FluidCubeRenderer):
- HoneyTankRenderer.java: supprimé renderFluidCube() local (163→81 lignes)
- HoneyReservoirRenderer.java: supprimé renderFluidCubeWithSprite() (~76 lignes)
- MultiblockTankRenderer.java: supprimé renderFluidCube() (~76 lignes)

Renderers debug (→ DebugRenderHelper):
- BeeDebugRenderer.java: supprimé renderLine(), addColoredLineVertex(), addLineVertex() (234→174 lignes)
- StorageControllerRenderer.java: supprimé drawLine(), outline inline code

Pipes (→ AbstractPipeBlock):
- HoneyPipeBlock.java: extends AbstractPipeBlock (401→153 lignes)
- ItemPipeBlock.java: extends AbstractPipeBlock (385→124 lignes)

Menus (→ BeemancerMenu):
- ManualCentrifugeMenu.java: extends BeemancerMenu, supprimé addPlayerInventory/Hotbar
- PoweredCentrifugeMenu.java: idem
- AlembicMenu.java: idem
- InfuserMenu.java: idem
- CrystallizerMenu.java: idem
- HoneyTankMenu.java: idem
- MultiblockTankMenu.java: idem
- IncubatorMenu.java: idem
- MagicHiveMenu.java: idem
- StorageControllerMenu.java: idem

Entity:
- MagicBeeEntity.java: supprimé inner class MoveToTargetGoal, import externe

BILAN:
- ~900 lignes de duplication éliminées
- 5 nouvelles classes utilitaires/base
- 18 fichiers existants simplifiés
- Zéro changement de comportement

================================================================================
2026-01-30 - Controller Pipe + Honey Consumption + Cleanup
================================================================================

NOUVEAU BLOC:
- ControllerPipeBlock: conduit structurel pour le multibloc Storage Controller
- Cube simple quand non formé, coude orienté quand formé (rendu BER)
- Remplace honey_pipe T1 aux 4 positions de pipe dans le pattern multibloc
- ControllerPipeBlockEntity: stocke rotation (0-7), spreadX/Z
- ControllerPipeRenderer: rendu du coude formed avec spread + rotation

HONEY CONSUMPTION:
- Le controller consomme du miel en continu quand formé (toutes les secondes)
- Drain depuis les 2 HoneyReservoirs du multibloc
- Formule: (base 20 mB/s + coffres × 10 + essences × level × 10) × (1 - efficiency)
- Insomnia essence donne honey efficiency: level × 10% (PERFECT = 40%)
- Si plus de miel: delivery bees bloquées (honeyDepleted)
- ContainerData étendu de 4 à 6 indices (+ consumption, efficiency)

GUI:
- 2 nouvelles stats dans StorageControllerScreen: "Honey" (mB/s), "Efficiency" (%)
- StorageControllerMenu: SimpleContainerData(6), getters consumption/efficiency

NETTOYAGE:
- Supprimé HoneyPipeRenderer.java (remplacé par ControllerPipeRenderer)
- Retiré champs formed de HoneyPipeBlockEntity (formed, formedRotation, formedSpreadX/Z)
- Terminal blockstate simplifié: toutes les variantes utilisent le modèle de base

REGISTRES:
- BeemancerBlocks: +CONTROLLER_PIPE
- BeemancerItems: +CONTROLLER_PIPE (BlockItem)
- BeemancerBlockEntities: +CONTROLLER_PIPE

ASSETS:
- blockstates/controller_pipe.json
- models/block/storage/controller_pipe.json (cube, texture honeyed_stone)
- models/block/storage/controller_pipe_formed.json (coude, copie honey_pipe_formed)
- models/item/controller_pipe.json
- data/beemancer/loot_table/blocks/controller_pipe.json
- Lang EN/FR: block.beemancer.controller_pipe, gui honey_consumption, honey_efficiency

================================================================================
2026-01-30 - Storage Controller: Controlled Hive, Terminal 2px, Spread 3px
================================================================================

Améliorations visuelles et structurelles du multibloc Storage Controller.

NOUVEAU BLOC:
- ControlledHiveBlock: bloc passif avec FORMED + FORMED_ROTATION
- Remplace le honeyed_stone en position (0,1,0) dans le pattern multibloc
- Le controller gère les abeilles via cette hive (spawn/retour)

TERMINAL FORMED:
- Réduit à 2px d'épaisseur (z=[14,16] au lieu de [13,16])
- Design: cadre de barres 2px + plan central texture portal nether

SPREAD COLONNES:
- Les colonnes pipe-reservoir-pipe écartées de 3px (3/16 bloc) du centre
- Spread calculé en world-space par StorageControllerBlockEntity
- HoneyPipeBlockEntity + HoneyReservoirBlockEntity: formedSpreadX/Z (NBT + sync)
- HoneyPipeRenderer + HoneyReservoirRenderer: translation spread avant rendu
- HoneyReservoirRenderer: rendu formed model via BER (blockstate model vidé)

REGISTRES:
- BeemancerBlocks: +CONTROLLED_HIVE
- BeemancerItems: +CONTROLLED_HIVE (BlockItem)

ASSETS:
- blockstates/controlled_hive.json (8 variants)
- models/block/storage/controlled_hive.json + controlled_hive_formed.json
- models/block/altar/honey_reservoir_formed_render.json (modèle pour BER)
- models/item/controlled_hive.json
- textures/block/storage/controlled_hive.png
- data/beemancer/loot_table/blocks/controlled_hive.json
- lang/en_us.json + fr_fr.json: +block.beemancer.controlled_hive

================================================================================
2026-01-29 - Storage Controller Multibloc
================================================================================

Transformation du Storage Controller en multibloc 3x3x3 (3 étages).
Utilise le système FORMED (blockstate property) comme l'altar.

JAVA MODIFIÉS:
- StorageControllerBlock.java: +FORMED property, formation clic droit, onRemove
- StorageControllerBlockEntity.java: implements MultiblockController, tryFormStorage()
- StorageTerminalBlock.java: +FORMED property
- HoneyPipeBlock.java: +FORMED property (13e boolean)
- MultiblockPatterns.java: +STORAGE_CONTROLLER pattern

JSON CRÉÉS:
- models/block/storage/storage_controller_formed.json (2 cubes 2×2×2)
- models/block/storage/storage_terminal_formed.json (3 plaques en Z)
- models/block/pipes/honey_pipe_formed.json (colonne 6×16×6)
- models/block/altar/honeyed_stone_formed.json (base + ailes)

JSON MODIFIÉS:
- models/block/altar/honey_reservoir_formed.json (cube 8×16×8)
- blockstates/storage_controller.json (formed variants)
- blockstates/storage_terminal.json (formed variants)
- blockstates/honey_pipe.json + tier2/3/4 (formed conditions multipart)
- blockstates/honeyed_stone.json (formed=true,layer=0 → modèle formed)

================================================================================
2026-01-29 - Suppression Système Lifetime
================================================================================

SUPPRESSIONS:
- content/gene/lifetime/ (dossier complet avec 3 gènes)
- GeneCategory.LIFETIME
- data/beemancer/genes/lifetime.json
- Structure/feature_lifetime_system.txt

MODIFICATIONS:
- BeeGeneData.java: Retiré tous les champs/méthodes lifetime
- MagicBeeEntity.java: Retiré DATA_LIFETIME_GENE, DATA_REMAINING_LIFETIME, tick lifetime
- MagicBeeItem.java: Retiré barre de durabilité et tooltip lifetime
- GeneInit.java: Retiré registerLifetimeGenes()
- BeeWandItem.java: Retiré track "Lifetime"
- BreedingManager.java: Retiré LIFETIME_COST_RATIO
- MagicHiveBlockEntity.java: Retiré coût lifetime dans attemptBreeding()
- HiveMultiblockBlockEntity.java: Retiré coût lifetime dans attemptBreeding()
- BeeStatueBlock.java: Retiré initializeLifetimeFromGene()

RAISON: Système obsolète, remplacé par abeilles immortelles.

================================================================================
2026-01-28 - Rideable Bee System (Architecture Cobblemon)
================================================================================

Système de monture pour abeilles basé sur l'architecture Cobblemon.
- RidingBehaviour stateless + RidingBehaviourState mutable
- Modes WALK (caméra libre) et RUN (style jet)
- HUD debug en haut à droite

================================================================================
2026-01-27 - Honey Altar + Reservoir Multibloc
================================================================================

Multibloc Honey Altar 3x3x5 avec:
- HoneyReservoirBlock (stockage fluide 4000mB)
- AltarHeartBlock (contrôleur)
- Renderer custom multibloc

================================================================================
HISTORIQUE ANTÉRIEUR: Voir commits Git
================================================================================

################################################################################

################################################################################
#                              BEEMANCER - STRUCTURE                           #
#                         Dernière mise à jour: 2026-01-22                     #
################################################################################

================================================================================
TABLE DES MATIÈRES
================================================================================
1. VUE D'ENSEMBLE
2. ARBORESCENCE COMPLÈTE
3. FICHIERS FONDAMENTAUX (CORE)
4. REGISTRES
5. FEATURES IMPLÉMENTÉES
6. FEATURES EN COURS
7. DÉPENDANCES UNIVERSELLES
8. GUIDE D'INTÉGRATION D'UNE FEATURE
9. CHANGELOG STRUCTURE

================================================================================
1. VUE D'ENSEMBLE
================================================================================

Mod: Beemancer
Version MC: 1.21.1
Loader: NeoForge
Package racine: com.chapeau.beemancer

Philosophie:
- Modularité maximale (1 script = 1 responsabilité)
- Système de gènes modulaire pour les abeilles
- Patterns inspirés de Create et Cobblemon

================================================================================
2. ARBORESCENCE COMPLÈTE
================================================================================

src/main/java/com/chapeau/beemancer/
│
├── Beemancer.java                      # [CORE] Point d'entrée du mod
│
├── core/                               # === FONDATIONS UNIVERSELLES ===
│   ├── registry/
│   │   ├── BeemancerItems.java
│   │   ├── BeemancerBlocks.java
│   │   ├── BeemancerBlockEntities.java
│   │   ├── BeemancerEntities.java
│   │   ├── BeemancerMenus.java
│   │   └── BeemancerCreativeTabs.java
│   │
│   ├── gene/                           # === SYSTÈME DE GÈNES ===
│   │   ├── Gene.java                   # Interface gène
│   │   ├── AbstractGene.java           # Classe abstraite de base
│   │   ├── GeneCategory.java           # Catégories de gènes
│   │   ├── GeneRegistry.java           # Registre des gènes
│   │   └── BeeGeneData.java            # Données gènes + lifetime
│   │
│   └── network/
│       ├── BeemancerNetwork.java
│       └── packets/
│           └── BeeCreatorActionPacket.java
│
├── common/                             # === LOGIQUE PARTAGÉE ===
│   ├── block/
│   │   ├── storage/
│   │   │   └── StorageCrateBlock.java
│   │   ├── beecreator/
│   │   │   ├── BeeCreatorBlock.java
│   │   │   └── BeeCreatorBlockEntity.java
│   │   └── hive/
│   │       ├── MagicHiveBlock.java
│   │       └── MagicHiveBlockEntity.java
│   │
│   ├── blockentity/storage/
│   │   └── StorageCrateBlockEntity.java
│   │
│   ├── item/bee/
│   │   ├── MagicBeeItem.java           # Item abeille avec gènes + durability bar
│   │   └── BeeWandItem.java            # Baguette de contrôle
│   │
│   ├── entity/bee/
│   │   └── MagicBeeEntity.java         # Entité abeille avec gènes + lifetime
│   │
│   ├── event/
│   │   └── BeeInteractionHandler.java
│   │
│   └── menu/
│       ├── StorageCrateMenu.java
│       ├── BeeCreatorMenu.java
│       ├── MagicHiveMenu.java
│       └── slot/
│           ├── OutputOnlySlot.java     # Slot extraction uniquement
│           └── BeeAssignmentSlot.java  # Slot pour abeilles
│
├── content/                            # === CONTENU PAR FEATURE ===
│   └── gene/                           # Implémentations des gènes
│       ├── GeneInit.java               # Initialisation des gènes
│       ├── species/
│       │   ├── SpeciesGene.java
│       │   ├── CommonSpeciesGene.java
│       │   ├── NobleSpeciesGene.java
│       │   └── DiligentSpeciesGene.java
│       ├── environment/
│       │   ├── EnvironmentGene.java
│       │   ├── NormalEnvironmentGene.java
│       │   ├── RobustEnvironmentGene.java
│       │   └── NocturnalEnvironmentGene.java
│       ├── flower/
│       │   ├── FlowerGene.java
│       │   ├── FlowersFlowerGene.java
│       │   ├── CropsFlowerGene.java
│       │   └── CavePlantsFlowerGene.java
│       └── lifetime/
│           ├── LifetimeGene.java
│           ├── ShortLifetimeGene.java
│           ├── NormalLifetimeGene.java
│           └── LongLifetimeGene.java
│
└── client/
    ├── ClientSetup.java
    └── gui/screen/
        ├── StorageCrateScreen.java
        ├── BeeCreatorScreen.java
        └── MagicHiveScreen.java

================================================================================
3. FICHIERS FONDAMENTAUX (CORE)
================================================================================

┌─────────────────────────────────────┬────────────────────────────────────────┐
│ Fichier                             │ Rôle                                   │
├─────────────────────────────────────┼────────────────────────────────────────┤
│ Beemancer.java                      │ Point d'entrée, init des gènes         │
│ core/gene/Gene.java                 │ Interface pour tous les gènes          │
│ core/gene/GeneRegistry.java         │ Registre central des gènes             │
│ core/gene/GeneCategory.java         │ Définition des catégories              │
│ core/gene/BeeGeneData.java          │ Stockage gènes + lifetime              │
│ content/gene/GeneInit.java          │ Enregistrement de tous les gènes       │
│ client/ClientSetup.java             │ Init client (screens, renderers)       │
└─────────────────────────────────────┴────────────────────────────────────────┘

================================================================================
4. REGISTRES
================================================================================

ITEMS:
| ID            | Classe          | Feature      |
|---------------|-----------------|--------------|
| storage_crate | BlockItem       | Storage      |
| bee_creator   | BlockItem       | Bee Creator  |
| magic_hive    | BlockItem       | Magic Hive   |
| magic_bee     | MagicBeeItem    | Gene System  |
| bee_wand      | BeeWandItem     | Bee Control  |

BLOCS:
| ID            | Classe           | BlockEntity? | Feature      |
|---------------|------------------|--------------|--------------|
| storage_crate | StorageCrateBlock| Oui          | Storage      |
| bee_creator   | BeeCreatorBlock  | Oui          | Gene Editor  |
| magic_hive    | MagicHiveBlock   | Oui          | Bee Housing  |

ENTITÉS:
| ID        | Classe          | Feature      |
|-----------|-----------------|--------------|
| magic_bee | MagicBeeEntity  | Gene System  |

MENUS:
| ID            | Classe           | Feature      |
|---------------|------------------|--------------|
| storage_crate | StorageCrateMenu | Storage      |
| bee_creator   | BeeCreatorMenu   | Gene Editor  |
| magic_hive    | MagicHiveMenu    | Bee Housing  |

================================================================================
5. FEATURES IMPLÉMENTÉES
================================================================================

--------------------------------------------------------------------------------
FEATURE: Gene System
--------------------------------------------------------------------------------
Description: Système modulaire de gènes pour les abeilles
Statut: COMPLÈTE

Architecture:
- GeneCategory: Catégorie de gènes (species, environment, flower, lifetime)
- Gene: Interface définissant un gène
- AbstractGene: Implémentation de base
- GeneRegistry: Registre central
- BeeGeneData: Stockage des gènes + lifetime d'une abeille

Catégories de gènes:
1. SPECIES (Espèce) - Couleur: Or
   - common: Standard
   - noble: +production, -vitesse
   - diligent: +vitesse, -production

2. ENVIRONMENT (Environnement) - Couleur: Vert
   - normal: Conditions standard
   - robust: Travaille sous la pluie
   - nocturnal: Travaille la nuit

3. FLOWER (Fleur) - Couleur: Violet
   - flowers: Fleurs standard
   - crops: Cultures
   - cave_plants: Plantes de caverne

4. LIFETIME (Durée de vie) - Couleur: Aqua
   - short: ~5 minutes
   - normal: ~20 minutes
   - long: ~60 minutes
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
FEATURE: Lifetime System
--------------------------------------------------------------------------------
Description: Système de durée de vie pour les abeilles
Statut: COMPLÈTE

- MagicBeeEntity décrémente le lifetime chaque seconde
- À 0, l'abeille meurt (discard)
- MagicBeeItem affiche une barre de durabilité (vert→rouge)
- Lifetime stocké dans BeeGeneData et synchronisé via EntityData
- Config JSON: data/beemancer/genes/lifetime.json
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
FEATURE: Magic Bee
--------------------------------------------------------------------------------
Description: Abeille avec système de gènes et lifetime
Statut: COMPLÈTE

- MagicBeeEntity: Entité avec BeeGeneData, lifetime countdown
- MagicBeeItem: Item avec tooltip gènes (shift) + barre durabilité
- Navigation contrôlée via BeeWand
- Support assignation ruche (hivePos, slot)
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
FEATURE: Bee Creator
--------------------------------------------------------------------------------
Description: Interface GUI pour modifier les gènes des abeilles
Statut: COMPLÈTE

- BeeCreatorBlock: Bloc machine
- BeeCreatorBlockEntity: Stockage de l'abeille
- BeeCreatorMenu: Logique de sélection des gènes
- BeeCreatorScreen: Interface avec flèches et bouton Edit
- Lignes dynamiques selon le nombre de catégories
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
FEATURE: Magic Hive
--------------------------------------------------------------------------------
Description: Ruche magique pour héberger les MagicBees
Statut: COMPLÈTE

Architecture:
- MagicHiveBlock: Bloc avec GUI
- MagicHiveBlockEntity: 12 slots (5 bee + 7 output), tracking états
- MagicHiveMenu: Slots custom (BeeAssignmentSlot, OutputOnlySlot)
- MagicHiveScreen: GUI avec layout honeycomb

Système d'assignation:
- États: EMPTY → INSIDE → OUTSIDE → INSIDE (cycle)
- Assigner: Placer MagicBeeItem dans slot
- Abeille dehors: Slot devient "ghost", UUID trackée
- Retrait ghost: Abeille dehors despawn
- Mort abeille: Slot se libère
- Retour ruche: Bee capturée, état INSIDE

Slots:
- 0-4: BeeAssignmentSlot (5 emplacements abeilles)
- 5-11: OutputOnlySlot (7 slots honeycomb, extraction seulement)
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
FEATURE: Bee Wand
--------------------------------------------------------------------------------
Description: Baguette pour contrôler les abeilles
Statut: COMPLÈTE

- Clic droit sur abeille: Sélectionne (son Ding)
- Clic droit sur bloc: Définit destination (son Dong)
- Shift+clic droit air: Désélectionne
- Tooltip affiche l'abeille sélectionnée
--------------------------------------------------------------------------------

================================================================================
6. FEATURES EN COURS
================================================================================

[Aucune]

================================================================================
7. DÉPENDANCES UNIVERSELLES
================================================================================

core/gene/:
- Gene.java: Interface pour créer de nouveaux gènes
- AbstractGene.java: Classe de base avec paramètres
- GeneCategory.java: Pour ajouter de nouvelles catégories
- GeneRegistry.java: Pour enregistrer et récupérer des gènes
- BeeGeneData.java: Stockage gènes + lifetime

common/menu/slot/:
- OutputOnlySlot.java: Slot extraction uniquement (pattern Create)
- BeeAssignmentSlot.java: Slot acceptant uniquement MagicBeeItem

================================================================================
8. GUIDE D'INTÉGRATION D'UNE FEATURE
================================================================================

Pour ajouter un nouveau gène:
1. Créer une classe dans content/gene/[category]/
2. Hériter de la classe de base de la catégorie (ex: SpeciesGene)
3. Enregistrer dans GeneInit.registerAllGenes()
4. Ajouter la config dans data/beemancer/genes/[category].json
5. Ajouter les traductions dans lang/*.json

Pour ajouter une nouvelle catégorie de gènes:
1. Ajouter dans GeneCategory.java
2. Créer le package content/gene/[category]/
3. Créer la classe de base [Category]Gene
4. Ajouter la config JSON
5. Ajouter les traductions

================================================================================
9. CHANGELOG STRUCTURE
================================================================================

--------------------------------------------------------------------------------
2026-01-22 - Lifetime System + Magic Hive
--------------------------------------------------------------------------------
- Ajout catégorie LIFETIME aux gènes (short, normal, long)
- MagicBeeEntity: countdown lifetime, mort automatique à 0
- MagicBeeItem: barre de durabilité (lifetime)
- Création MagicHiveBlock avec système d'assignation
- 5 slots bee + 7 slots output honeycomb
- États de tracking: EMPTY, INSIDE, OUTSIDE
- Notification ruche quand abeille meurt
- Slots custom: OutputOnlySlot, BeeAssignmentSlot
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
2026-01-21 - Refonte Gene System
--------------------------------------------------------------------------------
- Remplacement DebugBee par MagicBee avec système de gènes
- Création du système de gènes modulaire (core/gene/)
- Création des catégories: Species, Environment, Flower
- Création du BeeCreator avec GUI
- Mise à jour BeeWand pour MagicBee
- 9 gènes implémentés (3 par catégorie)
--------------------------------------------------------------------------------

################################################################################
#                              FIN DU DOCUMENT                                  #
################################################################################
